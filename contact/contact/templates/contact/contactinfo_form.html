{% extends "base.html" %}

{% load staticfiles %}
{% block header %}
<link rel="stylesheet" href="{% static "css/bootstrap.min.css" %}" type="text/css" />
<link rel="stylesheet" href="{% static "css/datetimepicker.css" %}" type="text/css" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="{% static "js/bootstrap.min.js" %}" type="text/javascript" ></script>
<script src="{% static "js/bootstrap-datetimepicker.js" %}" type="text/javascript" ></script>
<script src="{% static "js/jquery.form.js" %}" type="text/javascript" ></script>

{% endblock %}

{% block content %}

    <script type="text/javascript">
    $(document).ready(function(){
        function indicateProgress() {
                    $("form input, form textarea").prop('disabled', 'disabled');
			        $('#progress').show();
                }
        function ajaxFinish(){
                    $("form input, form textarea").removeProp('disabled');
                    $('#progress').hide()
                }
        var options = {
            target: $('body'),
            beforeSubmit: indicateProgress,
            success: ajaxFinish
        };

        $('form').submit(function() {
            // submit the form
            $(this).ajaxSubmit(options);
            // return false to prevent normal browser submit and page navigation
            return false;
        });
    });
</script>

<img id="progress" src="{% static "img/progress.gif" %}" alt="Progress..." />

{%load contact_filters %}
<form action="{{ action }}" method="POST" enctype="multipart/form-data">
        {% csrf_token %}
        <div>
		<div class="left">
		
	 	{% for field in form %}
	 		<div class="fieldWrapper">
				<p>
					{% if field.errors %}
							{{ field.errors }}
					{% endif %}
					<span>{{ field.label_tag }}</span> {{ field }}
				</p>
	 			{% if field|is_File %}
					<div class="photo">
					{% if contactinfo.photo %}
						<img src="{{ contactinfo.photo.url }}" alt="{{ contactinfo.name }} {{ contactinfo.surname }} Photo" />
					{% else %}
						<p>Photo was not uploaded yet</p>
					{% endif %}
					</div>
				{% endif %}
				</div>
				{% if forloop.counter == 4 %}
					</div><div class="left">
					<p>Contacts</p>
				{% endif %}
	    {% endfor %}
	    </div>
	</div>
	<div class="clear" ></div>
	<p>
		<input type="submit" value="Save" />
		<a href="{% url 'contact_view' %}">Cancel</a>
	</p>
</form>

{% endblock %}